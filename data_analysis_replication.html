<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lemeng">

<title>Data-analysis-replication</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="data_analysis_replication_files/libs/clipboard/clipboard.min.js"></script>
<script src="data_analysis_replication_files/libs/quarto-html/quarto.js"></script>
<script src="data_analysis_replication_files/libs/quarto-html/popper.min.js"></script>
<script src="data_analysis_replication_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="data_analysis_replication_files/libs/quarto-html/anchor.min.js"></script>
<link href="data_analysis_replication_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="data_analysis_replication_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="data_analysis_replication_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="data_analysis_replication_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="data_analysis_replication_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data-analysis-replication</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Lemeng </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="data-analysis-replication" class="level1">
<h1>Data analysis replication</h1>
<section id="paper-citation" class="level2">
<h2 class="anchored" data-anchor-id="paper-citation">Paper citation</h2>
<p>Lewis, R. J., Bueno, G. L., &amp; Di Fiore, A. (2022). Variation in female leverage: The influence of kinship and market effects on the extent of female power over males in verreaux’s sifaka. <em>Frontiers in Ecology and Evolution</em>, <em>10</em>, 851880. <a href="https://doi.org/10.3389/fevo.2022.851880" class="uri">https://doi.org/10.3389/fevo.2022.851880</a></p>
</section>
<section id="paper-outline" class="level2">
<h2 class="anchored" data-anchor-id="paper-outline">Paper outline</h2>
<section id="research-goal" class="level3">
<h3 class="anchored" data-anchor-id="research-goal">Research goal:</h3>
<p>The goal of the research is to examine how female economic power (leverage) in Verreaux’s sifaka varies with the value of mating opportunities. Specifically, the study tests whether indicators of mating opportunity value, such as a female’s kinship status with males, female parity status, reproductive season, and demographic aspects like the sex ratio within groups or populations, predict the extent to which females can influence male behavior during intersexual agonistic interactions.</p>
</section>
<section id="data-sets" class="level3">
<h3 class="anchored" data-anchor-id="data-sets">Data sets:</h3>
<p>The data used in this study was collected over more than a decade (2008–2019) in a population of Verreaux’s sifaka. Data from 2009 to 2010 was excluded in the analysis due to insufficiency caused by Cyclone Fanele. The final data incorporates approximately 14,000 hours of focal animal sampling across 10 social groups, during which detailed records of agonistic interactions were gathered, including both aggressive behaviors and submissive vocalizations. Complementing the behavioral data, monthly censuses provided demographic information such as group composition and sex ratios. Additionally, genetic analyses using 14 microsatellite markers from both fecal and tissue samples enabled precise determination of kinship among individuals.</p>
<p>The authors provided two datasheets for public access. The first datasheet has observations of submissive chatter behavior between females and males, while the second one records each outcome of every agonistic intersexual interaction. Both datasheets include data on adult and subadult individals. The link to the repository is: <a href="https://datadryad.org/dataset/doi:10.5061/dryad.ngf1vhhwh" class="uri">https://datadryad.org/dataset/doi:10.5061/dryad.ngf1vhhwh</a></p>
</section>
<section id="statistical-analysis" class="level3">
<h3 class="anchored" data-anchor-id="statistical-analysis">Statistical analysis:</h3>
</section>
</section>
<section id="replication-outline" class="level2">
<h2 class="anchored" data-anchor-id="replication-outline">Replication outline:</h2>
<ol type="1">
<li><p>Statistical description on submissive chatters and agonistic interaction outcomes.</p></li>
<li><p>Visualization of the outcomes of agonistic interactions in intersexual Verreaux’s sifaka dyads.</p></li>
<li><p>GLMMs on the effects of economic factors on the direction of submissive chatters. There are 2 models in total.</p></li>
<li><p>GLMMs on the effects of economic factors on the outcomes of agonistic interactions (male win vs.&nbsp;female win or neutral). There are 4 models in total.</p></li>
</ol>
</section>
<section id="analysis-replication" class="level2">
<h2 class="anchored" data-anchor-id="analysis-replication">Analysis replication:</h2>
<section id="library-packages" class="level3">
<h3 class="anchored" data-anchor-id="library-packages">library packages</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjstats)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstanarm)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-in-data-sets" class="level3">
<h3 class="anchored" data-anchor-id="load-in-data-sets">load in data sets</h3>
<p>There are two data sets used in the replication. Chatter: it contains the direction of submissive chatter between dyads. Win: it contains the outcomes of agonistic interactions between dyads.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>chatter <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"LewisEtAl2022_SubmissiveChatter_Dryad.xlsx"</span>, <span class="at">sheet =</span> <span class="dv">2</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(chatter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 21
  Date                 Year Season       Initiator Receiver InitiatorSex
  &lt;dttm&gt;              &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;       
1 2008-01-19 00:00:00  2008 matingSeason M28       F01      M           
2 2008-01-19 00:00:00  2008 matingSeason M28       F01      M           
3 2008-01-25 00:00:00  2008 matingSeason M28       F01      M           
4 2008-01-25 00:00:00  2008 matingSeason M28       F01      M           
5 2008-01-30 00:00:00  2008 matingSeason M28       F01      M           
6 2008-01-30 00:00:00  2008 matingSeason M28       F01      M           
# ℹ 15 more variables: InitiatorAgeClass &lt;chr&gt;, ReceiverSex &lt;chr&gt;,
#   ReceiverAgeClass &lt;chr&gt;, MaleSubmitToFemale &lt;dbl&gt;, MaleID &lt;chr&gt;,
#   FemaleID &lt;chr&gt;, MaleAgeClass &lt;chr&gt;, FemaleAgeClass &lt;chr&gt;,
#   FemaleReproductiveStatus &lt;chr&gt;, Relatedness &lt;dbl&gt;,
#   PopSexRatioFOverN_AdultsOnly &lt;chr&gt;,
#   GroupSexRatioFOverGroupN_AdultsOnly &lt;chr&gt;,
#   PopSexRatioFOverN_SubsAndAdults &lt;dbl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>win <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"LewisEtAl2022_WinsData_Dryad.xlsx"</span>, <span class="at">sheet=</span><span class="dv">1</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(win)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 25
  Date                 Year Season      Initiator Receiver Behavior InitiatorSex
  &lt;dttm&gt;              &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;       
1 2017-06-11 00:00:00  2017 nonMatingS… F17       M24      Supplant F           
2 2017-06-11 00:00:00  2017 nonMatingS… F17       M24      Supplant F           
3 2017-06-11 00:00:00  2017 nonMatingS… F17       M24      Supplant F           
4 2017-07-11 00:00:00  2017 nonMatingS… F17       M24      Supplant F           
5 2017-07-11 00:00:00  2017 nonMatingS… F17       M24      Supplant F           
6 2017-07-11 00:00:00  2017 nonMatingS… F17       M24      Supplant F           
# ℹ 18 more variables: InitiatorAgeClass &lt;chr&gt;, ReceiverSex &lt;chr&gt;,
#   ReceiverAgeClass &lt;chr&gt;, BoutID &lt;chr&gt;, DidAnyoneWin1v0 &lt;dbl&gt;,
#   DidMaleWinWithNeutral &lt;dbl&gt;, DidMaleWinWithoutNeutral &lt;chr&gt;, MaleID &lt;chr&gt;,
#   FemaleID &lt;chr&gt;, MaleAgeClass &lt;chr&gt;, FemaleAgeClass &lt;chr&gt;,
#   FemaleReproductiveStatus &lt;chr&gt;, Relatedness &lt;dbl&gt;,
#   PopSexRatioFOverN_AdultsOnly &lt;chr&gt;,
#   GroupSexRatioFOverGroupN_AdultsOnly &lt;chr&gt;, …</code></pre>
</div>
</div>
</section>
<section id="statistical-description" class="level3">
<h3 class="anchored" data-anchor-id="statistical-description">Statistical description</h3>
<section id="summary-for-chatter" class="level4">
<h4 class="anchored" data-anchor-id="summary-for-chatter">1. Summary for Chatter</h4>
<p>The table includes: the number of observations, number of individuals, number of adults, number of subadults, number of females (and females in both age classes), number of males (and males in both age classes), number of dyads, number of related dyads, number of unrelated dyads.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>summary_chatter <span class="ot">&lt;-</span> chatter <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_obs =</span> <span class="fu">n</span>(),</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">unique_adults =</span> <span class="fu">n_distinct</span>(<span class="fu">c</span>(Initiator[InitiatorAgeClass <span class="sc">==</span> <span class="st">"adult"</span>], Receiver[ReceiverAgeClass <span class="sc">==</span> <span class="st">"adult"</span>])),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">unique_subadults =</span> <span class="fu">n_distinct</span>(<span class="fu">c</span>(Initiator[InitiatorAgeClass <span class="sc">==</span> <span class="st">"subadult"</span>], Receiver[ReceiverAgeClass <span class="sc">==</span> <span class="st">"subadult"</span>])),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">unique_individuals =</span> <span class="fu">n_distinct</span>(<span class="fu">c</span>(Initiator, Receiver)),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">females_in_both_age_classes =</span> <span class="fu">n_distinct</span>(</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">intersect</span>(</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">c</span>(Initiator[InitiatorAgeClass <span class="sc">==</span> <span class="st">"adult"</span><span class="sc">&amp;</span>InitiatorSex <span class="sc">==</span> <span class="st">"F"</span>], Receiver[ReceiverAgeClass <span class="sc">==</span> <span class="st">"adult"</span><span class="sc">&amp;</span>ReceiverSex <span class="sc">==</span> <span class="st">"F"</span>]),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">c</span>(Initiator[InitiatorAgeClass <span class="sc">==</span> <span class="st">"subadult"</span><span class="sc">&amp;</span>InitiatorSex <span class="sc">==</span> <span class="st">"F"</span>], Receiver[ReceiverAgeClass <span class="sc">==</span> <span class="st">"subadult"</span><span class="sc">&amp;</span>ReceiverSex <span class="sc">==</span> <span class="st">"F"</span>])</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>      )),</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">males_in_both_age_classes =</span> <span class="fu">n_distinct</span>(</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">intersect</span>(</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">c</span>(Initiator[InitiatorAgeClass <span class="sc">==</span> <span class="st">"adult"</span><span class="sc">&amp;</span>InitiatorSex <span class="sc">==</span> <span class="st">"M"</span>], Receiver[ReceiverAgeClass <span class="sc">==</span> <span class="st">"adult"</span><span class="sc">&amp;</span>ReceiverSex <span class="sc">==</span> <span class="st">"M"</span>]),</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">c</span>(Initiator[InitiatorAgeClass <span class="sc">==</span> <span class="st">"subadult"</span><span class="sc">&amp;</span>InitiatorSex <span class="sc">==</span> <span class="st">"M"</span>], Receiver[ReceiverAgeClass <span class="sc">==</span> <span class="st">"subadult"</span><span class="sc">&amp;</span>ReceiverSex <span class="sc">==</span> <span class="st">"M"</span>])</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>      )),</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">unique_females =</span> <span class="fu">n_distinct</span>(<span class="fu">c</span>(Initiator[InitiatorSex <span class="sc">==</span> <span class="st">"F"</span>], Receiver[ReceiverSex <span class="sc">==</span> <span class="st">"F"</span>])),</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">unique_males =</span> <span class="fu">n_distinct</span>(<span class="fu">c</span>(Initiator[InitiatorSex <span class="sc">==</span> <span class="st">"M"</span>], Receiver[ReceiverSex <span class="sc">==</span> <span class="st">"M"</span>])),</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">unique_dyads =</span> <span class="fu">n_distinct</span>(<span class="fu">paste</span>(<span class="fu">pmin</span>(Initiator, Receiver), <span class="fu">pmax</span>(Initiator, Receiver))),</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">dyad_related =</span> <span class="fu">n_distinct</span>(<span class="fu">paste</span>(<span class="fu">pmin</span>(Initiator, Receiver), <span class="fu">pmax</span>(Initiator, Receiver))[Relatedness <span class="sc">==</span> <span class="dv">1</span>]),</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">dyad_unrelated =</span> <span class="fu">n_distinct</span>(<span class="fu">paste</span>(<span class="fu">pmin</span>(Initiator, Receiver), <span class="fu">pmax</span>(Initiator, Receiver))[Relatedness <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">%&gt;%</span> </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>   <span class="fu">pivot_longer</span>(</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">everything</span>(),         </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"variable"</span>,</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_chatter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 2
   variable                    value
   &lt;chr&gt;                       &lt;int&gt;
 1 n_obs                        1899
 2 unique_adults                  37
 3 unique_subadults               31
 4 unique_individuals             52
 5 females_in_both_age_classes     6
 6 males_in_both_age_classes      10
 7 unique_females                 24
 8 unique_males                   28
 9 unique_dyads                   72
10 dyad_related                   22
11 dyad_unrelated                 50</code></pre>
</div>
</div>
</section>
<section id="summary-for-win" class="level4">
<h4 class="anchored" data-anchor-id="summary-for-win">2. Summary for Win</h4>
<p>The table includes: the number of observations, number of individuals, number of adults, number of subadults, number of females (and females in both age classes), number of males (and males in both age classes), number of dyads, number of related dyads, number of unrelated dyads, number of observations when male wins, number of observations when female wins or the result is neutural.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>summary_win <span class="ot">&lt;-</span> win <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_obs =</span> <span class="fu">n</span>(),</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">unique_adults =</span> <span class="fu">n_distinct</span>(<span class="fu">c</span>(Initiator[InitiatorAgeClass <span class="sc">==</span> <span class="st">"adult"</span>], Receiver[ReceiverAgeClass <span class="sc">==</span> <span class="st">"adult"</span>])),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">unique_subadults =</span> <span class="fu">n_distinct</span>(<span class="fu">c</span>(Initiator[InitiatorAgeClass <span class="sc">==</span> <span class="st">"subadult"</span>], Receiver[ReceiverAgeClass <span class="sc">==</span> <span class="st">"subadult"</span>])),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">unique_individuals =</span> <span class="fu">n_distinct</span>(<span class="fu">c</span>(Initiator, Receiver)),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">females_in_both_age_classes =</span> <span class="fu">n_distinct</span>(</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">intersect</span>(</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">c</span>(Initiator[InitiatorAgeClass <span class="sc">==</span> <span class="st">"adult"</span><span class="sc">&amp;</span>InitiatorSex <span class="sc">==</span> <span class="st">"F"</span>], Receiver[ReceiverAgeClass <span class="sc">==</span> <span class="st">"adult"</span><span class="sc">&amp;</span>ReceiverSex <span class="sc">==</span> <span class="st">"F"</span>]),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">c</span>(Initiator[InitiatorAgeClass <span class="sc">==</span> <span class="st">"subadult"</span><span class="sc">&amp;</span>InitiatorSex <span class="sc">==</span> <span class="st">"F"</span>], Receiver[ReceiverAgeClass <span class="sc">==</span> <span class="st">"subadult"</span><span class="sc">&amp;</span>ReceiverSex <span class="sc">==</span> <span class="st">"F"</span>])</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>      )),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">males_in_both_age_classes =</span> <span class="fu">n_distinct</span>(</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">intersect</span>(</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">c</span>(Initiator[InitiatorAgeClass <span class="sc">==</span> <span class="st">"adult"</span><span class="sc">&amp;</span>InitiatorSex <span class="sc">==</span> <span class="st">"M"</span>], Receiver[ReceiverAgeClass <span class="sc">==</span> <span class="st">"adult"</span><span class="sc">&amp;</span>ReceiverSex <span class="sc">==</span> <span class="st">"M"</span>]),</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">c</span>(Initiator[InitiatorAgeClass <span class="sc">==</span> <span class="st">"subadult"</span><span class="sc">&amp;</span>InitiatorSex <span class="sc">==</span> <span class="st">"M"</span>], Receiver[ReceiverAgeClass <span class="sc">==</span> <span class="st">"subadult"</span><span class="sc">&amp;</span>ReceiverSex <span class="sc">==</span> <span class="st">"M"</span>])</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>      )),</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">unique_females =</span> <span class="fu">n_distinct</span>(<span class="fu">c</span>(Initiator[InitiatorSex <span class="sc">==</span> <span class="st">"F"</span>], Receiver[ReceiverSex <span class="sc">==</span> <span class="st">"F"</span>])),</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">unique_males =</span> <span class="fu">n_distinct</span>(<span class="fu">c</span>(Initiator[InitiatorSex <span class="sc">==</span> <span class="st">"M"</span>], Receiver[ReceiverSex <span class="sc">==</span> <span class="st">"M"</span>])),</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">unique_dyads =</span> <span class="fu">n_distinct</span>(<span class="fu">paste</span>(<span class="fu">pmin</span>(Initiator, Receiver), <span class="fu">pmax</span>(Initiator, Receiver))),</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">dyad_related =</span> <span class="fu">n_distinct</span>(<span class="fu">paste</span>(<span class="fu">pmin</span>(Initiator, Receiver), <span class="fu">pmax</span>(Initiator, Receiver))[Relatedness <span class="sc">==</span> <span class="dv">1</span>]),</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">dyad_unrelated =</span> <span class="fu">n_distinct</span>(<span class="fu">paste</span>(<span class="fu">pmin</span>(Initiator, Receiver), <span class="fu">pmax</span>(Initiator, Receiver))[Relatedness <span class="sc">==</span> <span class="dv">0</span>]),</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">n_malewin =</span> <span class="fu">nrow</span>(win <span class="sc">%&gt;%</span> <span class="fu">filter</span>(DidMaleWinWithNeutral <span class="sc">==</span> <span class="st">"1"</span>)),</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">n_femalewin_or_neutural =</span> <span class="fu">nrow</span>(win <span class="sc">%&gt;%</span> <span class="fu">filter</span>(DidMaleWinWithNeutral <span class="sc">==</span> <span class="st">"0"</span>))</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">%&gt;%</span> </span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>   <span class="fu">pivot_longer</span>(</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">everything</span>(),         </span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"variable"</span>,</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_win)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 2
   variable                    value
   &lt;chr&gt;                       &lt;int&gt;
 1 n_obs                        2448
 2 unique_adults                  37
 3 unique_subadults               30
 4 unique_individuals             49
 5 females_in_both_age_classes     8
 6 males_in_both_age_classes      10
 7 unique_females                 23
 8 unique_males                   26
 9 unique_dyads                   74
10 dyad_related                   20
11 dyad_unrelated                 54
12 n_malewin                     956
13 n_femalewin_or_neutural      1492</code></pre>
</div>
</div>
</section>
<section id="boxplot-for-outcomes-of-agonistic-interactions-in-intersexual-verreauxs-sifaka-dyads-for-adults-and-subadults" class="level4">
<h4 class="anchored" data-anchor-id="boxplot-for-outcomes-of-agonistic-interactions-in-intersexual-verreauxs-sifaka-dyads-for-adults-and-subadults">3. <strong>B</strong>oxplot for outcomes of agonistic interactions in intersexual Verreaux’s sifaka dyads (for adults and subadults)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>chatter_adult <span class="ot">&lt;-</span> chatter <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(InitiatorAgeClass<span class="sc">==</span><span class="st">"adult"</span> <span class="sc">&amp;</span> ReceiverAgeClass<span class="sc">==</span><span class="st">"adult"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Relatedness))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>submission_percentage <span class="ot">&lt;-</span> chatter <span class="sc">%&gt;%</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FemaleID) <span class="sc">%&gt;%</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">male_to_female_submission =</span> <span class="fu">sum</span>(MaleSubmitToFemale<span class="sc">==</span><span class="st">"1"</span>),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_chatter =</span> <span class="fu">n</span>(),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">submission_percent =</span> (male_to_female_submission <span class="sc">/</span> total_chatter) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>win_percentage <span class="ot">&lt;-</span> win <span class="sc">%&gt;%</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FemaleID) <span class="sc">%&gt;%</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">female_wins =</span> <span class="fu">sum</span>(DidMaleWinWithoutNeutral<span class="sc">==</span><span class="st">"0"</span>),</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_wins =</span> <span class="fu">n</span>(),</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">win_percent =</span> (female_wins <span class="sc">/</span> total_wins) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>chatter_win <span class="ot">&lt;-</span> <span class="fu">full_join</span>(submission_percentage <span class="sc">%&gt;%</span> <span class="fu">select</span>(FemaleID, submission_percent), win_percentage <span class="sc">%&gt;%</span> <span class="fu">select</span>(FemaleID, win_percent), <span class="at">by=</span><span class="st">"FemaleID"</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>chatter_win_long <span class="ot">&lt;-</span> chatter_win <span class="sc">%&gt;%</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FemaleID, submission_percent, win_percent) <span class="sc">%&gt;%</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(submission_percent, win_percent),</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"label"</span>,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) </span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co"># write labels for the plot</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>chatter_win_long <span class="ot">&lt;-</span> chatter_win_long <span class="sc">%&gt;%</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">case_when</span>(</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    label <span class="sc">==</span> <span class="st">"submission_percent"</span> <span class="sc">~</span> <span class="st">"Male-to-Female-Submission"</span>,</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>    label <span class="sc">==</span> <span class="st">"win_percent"</span> <span class="sc">~</span> <span class="st">"Female Wins"</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="co"># create boxplot</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(chatter_win_long, <span class="fu">aes</span>(<span class="at">x =</span> label, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"% of Total Intersexual Agonistic Interactions"</span>,</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Figure 1: outcomes of agonistic interactions"</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">scale =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Male-to-Female-Submission"</span>, <span class="st">"Female Wins"</span>))<span class="sc">+</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_replication_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>When one individual chattered submissively, males more often chattered at females (N=1,705) than females chattered at males (N=194). Percent of conflicts for which females won (N=816) out of the total agonistic iteractions (N=2448).</p>
<p><strong>Compared to the boxplot including adult and subadult individials in supplementary materials (below), the boxplot I created (figure 1) has the same general trend in data, but there are also some differences:</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="adult&amp;subadult_boxplot.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="600"></p>
</figure>
</div>
<ul>
<li><p>For “female wins” category, there are two data points scored as 100%. However, according to my calculation, there is only one data point scored as 100%. If I exclude “outlier.shape = NA” in the plotting, I will get two data points too (figure 1a). However, this doesn’t explain the seemingly duplicate data points in the figure from supplementary materials.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(chatter_win_long, <span class="fu">aes</span>(<span class="at">x =</span> label, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"% of Total Intersexual Agonistic Interactions"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Figure 1a: outcomes of agonistic interactions"</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">scale =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Male-to-Female-Submission"</span>, <span class="st">"Female Wins"</span>))<span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_replication_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>In the supplementary material, the figure legend explains “When one individual chattered submissively, males more often chattered at females (N=1,664) than females chattered at males (N=192)”. The sum of them is 1856, which is different from the dataset used for this plot. The sum of chatters for my plot is 1899. From the supplementary material, I failed to find explanation for this. It is possible that some rows were filtered out because of the uncertainty in one individual’s age, but this change was not included in the data for public access.</p></li>
</ul>
</section>
<section id="models-for-the-direction-of-chatter-in-adult-individuals" class="level4">
<h4 class="anchored" data-anchor-id="models-for-the-direction-of-chatter-in-adult-individuals">4. Models for the direction of chatter in adult individuals</h4>
<p>no bout id in the data sheet?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Fit the model with 4 MCMC chains, 10,000 iterations, and a 50% warmup period</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>model1a <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> MaleSubmitToFemale <span class="sc">~</span> Relatedness <span class="sc">+</span> Parity <span class="sc">+</span> Season <span class="sc">+</span> PopSexRatioFOverN_AdultsOnly  <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                        (<span class="dv">1</span> <span class="sc">|</span> MaleID) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> FemaleID) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> BoutID),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">bernoulli</span>(),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> chatter_adult,  </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">iter =</span> <span class="dv">10000</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">warmup =</span> <span class="dv">5000</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.95</span>))</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="models-for-outcomes-of-agonistic-interactions-involving-adults" class="level4">
<h4 class="anchored" data-anchor-id="models-for-outcomes-of-agonistic-interactions-involving-adults">5. Models for outcomes of agonistic interactions involving adults</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Select adult individuals in the dataset</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>win_adult <span class="ot">&lt;-</span> win <span class="sc">%&gt;%</span> <span class="fu">filter</span>(InitiatorAgeClass <span class="sc">==</span> <span class="st">"adult"</span><span class="sc">&amp;</span>ReceiverAgeClass <span class="sc">==</span> <span class="st">"adult"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="do">## There are 1850 observations in the dataset of adult individuals</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Select data based on the sex of initiator</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>win_adult_female <span class="ot">&lt;-</span> win_adult <span class="sc">%&gt;%</span> <span class="fu">filter</span>(InitiatorSex <span class="sc">==</span> <span class="st">"F"</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>win_adult_male <span class="ot">&lt;-</span> win_adult <span class="sc">%&gt;%</span> <span class="fu">filter</span>(InitiatorSex <span class="sc">==</span> <span class="st">"M"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>5.1 Female-initiated agonistic interactions</strong></p>
<p>In the following 2 models, the response variable is whether the male won the encounter (male win vs.&nbsp;female win or neutral).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Variable type conversion for sex ratio and relatedness predictors</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>win_adult_female<span class="sc">$</span>Relatedness <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(win_adult_female<span class="sc">$</span>Relatedness)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>win_adult_female<span class="sc">$</span>PopSexRatioFOverN_AdultsOnly <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(win_adult_female<span class="sc">$</span>PopSexRatioFOverN_AdultsOnly)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>win_adult_female<span class="sc">$</span>GroupSexRatioFOverGroupN_AdultsOnly <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(win_adult_female<span class="sc">$</span>GroupSexRatioFOverGroupN_AdultsOnly)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="do">## **Fit bayesian model using population sex ratio</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>model2a_females <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> DidMaleWinWithNeutral  <span class="sc">~</span> Relatedness <span class="sc">+</span> FemaleReproductiveStatus <span class="sc">+</span> Season <span class="sc">+</span> PopSexRatioFOverN_AdultsOnly  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> MaleID) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> FemaleID) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> BoutID),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">family =</span> <span class="fu">bernoulli</span>(),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> win_adult_female,  </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">iter =</span> <span class="dv">10000</span>,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">warmup =</span> <span class="dv">5000</span>,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.95</span>))</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Summarize model result</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2a_females)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Get odds ratio</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>model2a_females_result <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">exp</span>(<span class="fu">fixef</span>(model2a_females)))</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Get percentage in ROPE value</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>model2a_female_rope <span class="ot">&lt;-</span> <span class="fu">rope</span>(model2a_females)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>model2a_female_rope<span class="sc">$</span>Parameter <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">"^b_"</span>, <span class="st">""</span>, model2a_female_rope<span class="sc">$</span>Parameter)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Combine the results for model2afemales</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>model2a_females_result_rope <span class="ot">&lt;-</span> <span class="fu">cbind</span>(model2a_females_result, <span class="at">ROPE =</span> (model2a_female_rope<span class="sc">$</span>ROPE_Percentage)<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="do">## **Fit bayesian model using group sex ratio</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>model2b_females <span class="ot">&lt;-</span>  <span class="fu">brm</span>(<span class="at">formula =</span> DidMaleWinWithNeutral  <span class="sc">~</span> Relatedness <span class="sc">+</span> FemaleReproductiveStatus <span class="sc">+</span> Season <span class="sc">+</span> GroupSexRatioFOverGroupN_AdultsOnly  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> MaleID) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> FemaleID) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> BoutID),</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>                        <span class="at">family =</span> <span class="fu">bernoulli</span>(),</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> win_adult_female,  </span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>                        <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>                        <span class="at">iter =</span> <span class="dv">10000</span>,</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>                        <span class="at">warmup =</span> <span class="dv">5000</span>,</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>                        <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.95</span>))</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Summarize model result</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2b_females)</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="do">## Get odds ratio</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>model2b_females_result <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">exp</span>(<span class="fu">fixef</span>(model2b_females)))</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a><span class="do">## Get percentage in ROPE value</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>model2b_female_rope <span class="ot">&lt;-</span> <span class="fu">rope</span>(model2b_females)</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>model2b_female_rope<span class="sc">$</span>Parameter <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">"^b_"</span>, <span class="st">""</span>, model2b_female_rope<span class="sc">$</span>Parameter)</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a><span class="do">## Combine the results for model2afemales</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>model2b_females_result_rope <span class="ot">&lt;-</span> <span class="fu">cbind</span>(model2b_females_result, <span class="at">ROPE =</span> (model2b_female_rope<span class="sc">$</span>ROPE_Percentage)<span class="sc">*</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>5.2 <strong>Male-initiated agonistic interactions</strong></p>
<p>In the following 2 models, the response variable is whether the male won the encounter (male win vs.&nbsp;female win or neutral).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Variable type conversion for sex ratio and relatedness predictors</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>win_adult_male<span class="sc">$</span>Relatedness <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(win_adult_male<span class="sc">$</span>Relatedness)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>win_adult_male<span class="sc">$</span>PopSexRatioFOverN_AdultsOnly <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(win_adult_male<span class="sc">$</span>PopSexRatioFOverN_AdultsOnly)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>win_adult_male<span class="sc">$</span>GroupSexRatioFOverGroupN_AdultsOnly <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(win_adult_male<span class="sc">$</span>GroupSexRatioFOverGroupN_AdultsOnly)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="do">## **Fit bayesian model using population sex ratio</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>model2a_males <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> DidMaleWinWithNeutral  <span class="sc">~</span> Relatedness <span class="sc">+</span> FemaleReproductiveStatus <span class="sc">+</span> Season <span class="sc">+</span> PopSexRatioFOverN_AdultsOnly  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> MaleID) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> FemaleID) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> BoutID),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">family =</span> <span class="fu">bernoulli</span>(),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> win_adult_male,  </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">iter =</span> <span class="dv">10000</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">warmup =</span> <span class="dv">5000</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.95</span>))</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Summarize model result</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2a_males)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Get odds ratio</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>model2a_males_result <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">exp</span>(<span class="fu">fixef</span>(model2a_males)))</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Get percentage in ROPE value</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>model2a_male_rope <span class="ot">&lt;-</span> <span class="fu">rope</span>(model2a_males)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>model2a_male_rope<span class="sc">$</span>Parameter <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">"^b_"</span>, <span class="st">""</span>, model2a_male_rope<span class="sc">$</span>Parameter)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Combine the results for model2afemales</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>model2a_males_result_rope <span class="ot">&lt;-</span> <span class="fu">cbind</span>(model2a_males_result, <span class="at">ROPE =</span>(model2a_male_rope<span class="sc">$</span>ROPE_Percentage)<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>model2b_males <span class="ot">&lt;-</span>  <span class="fu">brm</span>(<span class="at">formula =</span> DidMaleWinWithNeutral  <span class="sc">~</span> Relatedness <span class="sc">+</span> FemaleReproductiveStatus <span class="sc">+</span> Season <span class="sc">+</span> GroupSexRatioFOverGroupN_AdultsOnly  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> MaleID) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> FemaleID) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> BoutID),</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>                        <span class="at">family =</span> <span class="fu">bernoulli</span>(),</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> win_adult_male,  </span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>                        <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>                        <span class="at">iter =</span> <span class="dv">10000</span>,</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>                        <span class="at">warmup =</span> <span class="dv">5000</span>,</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>                        <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.95</span>))</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2b_males)</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>model2b_males_result <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">exp</span>(<span class="fu">fixef</span>(model2b_males)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>